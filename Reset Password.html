<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="login.css">
    <title>Reset Password</title>
</head>
<body>

    
    <div class="logo-container">
        <img src="logo.jpeg" alt="Company Logo" class="logo">
    </div>

    
    <div class="form-container">
        <h1>Login</h1>

        <form id="resetForm">
            <label for="OgtaxID">TRN</label>
            <input type="number" id="OgtaxID" placeholder="Enter your TRN" pattern="\d{3}-\d{3}-\d{3}" required>

            <label for="Newpwd">Password:</label>
            <input type="password" id="Newpwd" placeholder="Enter Password" required minlength="8">

            <button type="submit">Login</button>
        </form>
    </div>
    
    
    <script src="/registration.js">
        

        const resetPassword= document.getElementById("resetForm")

        function resetLogin(event) {
            event.preventDefault(); 

            const enteredTRN = document.getElementById("OgtaxID");
            let registrations= JSON.parse(localStorage.getItem("RegistrationData")) || []

            // This makes checks that the TRN is valid and if so then the user can reset their password.
            user= registrations.find(user => user.trn=== enteredTRN)
            if (user){
                const newPassword= prompt ("Enter your new password.")
                if (newPassword.length>= 8){
                    user.password= newPassword
                    localStorage.setItem("RegistrationData", JSON.stringify(registration))
                    alert ("Password reset successful")
                    }
                    else{
                        alert("Password must be at least 8 characters long.")
                    }
                }
            else{
                alert("TRN not found.")
            }
            }
            

        resetPassword.addEventListener("click", resetLogin);
    </script>

</body>
</html>
